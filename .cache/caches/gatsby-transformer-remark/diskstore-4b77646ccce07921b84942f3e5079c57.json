{"expireTime":9007200882537890000,"key":"transformer-remark-markdown-ast-cd93aa1ee78d304d3db13328e5e38796-gatsby-remark-external-linksgatsby-remark-imagesgatsby-remark-code-titlesgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Okay let's setup the scenario here.","position":{"start":{"line":2,"column":2,"offset":2},"end":{"line":2,"column":37,"offset":37}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":38,"offset":38}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":38,"offset":38}}},{"type":"paragraph","children":[{"type":"text","value":"Let's say you have a Node.js API and some front end framework, and you are using AWS Cognito to handle the authentication dance ðŸ’ƒ via the client side SDK either through Amplify or some other means.","position":{"start":{"line":4,"column":1,"offset":40},"end":{"line":4,"column":199,"offset":238}}}],"position":{"start":{"line":4,"column":1,"offset":40},"end":{"line":4,"column":199,"offset":238}}},{"type":"paragraph","children":[{"type":"text","value":"Now you also want to ","position":{"start":{"line":6,"column":1,"offset":240},"end":{"line":6,"column":22,"offset":261}}},{"type":"strong","children":[{"type":"text","value":"authenticate","position":{"start":{"line":6,"column":24,"offset":263},"end":{"line":6,"column":36,"offset":275}}}],"position":{"start":{"line":6,"column":22,"offset":261},"end":{"line":6,"column":38,"offset":277}}},{"type":"text","value":" your API calls against the ","position":{"start":{"line":6,"column":38,"offset":277},"end":{"line":6,"column":66,"offset":305}}},{"type":"strong","children":[{"type":"text","value":"same user","position":{"start":{"line":6,"column":68,"offset":307},"end":{"line":6,"column":77,"offset":316}}}],"position":{"start":{"line":6,"column":66,"offset":305},"end":{"line":6,"column":79,"offset":318}}},{"type":"text","value":", against the ","position":{"start":{"line":6,"column":79,"offset":318},"end":{"line":6,"column":93,"offset":332}}},{"type":"strong","children":[{"type":"text","value":"same token","position":{"start":{"line":6,"column":95,"offset":334},"end":{"line":6,"column":105,"offset":344}}}],"position":{"start":{"line":6,"column":93,"offset":332},"end":{"line":6,"column":107,"offset":346}}},{"type":"text","value":". This easily done by using that JWT and a JWKS on the server side to validate the JWT signature.","position":{"start":{"line":6,"column":107,"offset":346},"end":{"line":6,"column":204,"offset":443}}}],"position":{"start":{"line":6,"column":1,"offset":240},"end":{"line":6,"column":205,"offset":444}}},{"type":"paragraph","children":[{"type":"text","value":"I'll show you how via a typical middleware.","position":{"start":{"line":8,"column":1,"offset":446},"end":{"line":8,"column":44,"offset":489}}}],"position":{"start":{"line":8,"column":1,"offset":446},"end":{"line":8,"column":44,"offset":489}}},{"type":"paragraph","children":[{"type":"text","value":"First head over to ","position":{"start":{"line":10,"column":1,"offset":491},"end":{"line":10,"column":20,"offset":510}}},{"type":"link","title":null,"url":"https://jwt.io","children":[{"type":"text","value":"jwt.io","position":{"start":{"line":10,"column":21,"offset":511},"end":{"line":10,"column":27,"offset":517}}}],"position":{"start":{"line":10,"column":20,"offset":510},"end":{"line":10,"column":44,"offset":534}},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":", this amazing tool will decode your JWT into something readable like ðŸ‘‡","position":{"start":{"line":10,"column":44,"offset":534},"end":{"line":10,"column":116,"offset":606}}}],"position":{"start":{"line":10,"column":1,"offset":491},"end":{"line":10,"column":116,"offset":606}}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://dev-to-uploads.s3.amazonaws.com/i/pxvqbad24evh7muafdbz.png","alt":"Alt Text","position":{"start":{"line":12,"column":1,"offset":608},"end":{"line":12,"column":80,"offset":687}}}],"position":{"start":{"line":12,"column":1,"offset":608},"end":{"line":12,"column":80,"offset":687}}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"On to the Node.js middleware","position":{"start":{"line":14,"column":2,"offset":690},"end":{"line":14,"column":30,"offset":718}}}],"position":{"start":{"line":14,"column":1,"offset":689},"end":{"line":14,"column":31,"offset":719}}}],"position":{"start":{"line":14,"column":1,"offset":689},"end":{"line":14,"column":31,"offset":719}}},{"type":"paragraph","children":[{"type":"text","value":"Let's start with a class so we can define some protected functions. You could also just do functional programming here too. Whatever floats your boat â›µ","position":{"start":{"line":16,"column":1,"offset":721},"end":{"line":16,"column":152,"offset":872}}}],"position":{"start":{"line":16,"column":1,"offset":721},"end":{"line":16,"column":152,"offset":872}}},{"type":"paragraph","children":[{"type":"text","value":"Using ","position":{"start":{"line":18,"column":1,"offset":874},"end":{"line":18,"column":7,"offset":880}}},{"type":"link","title":null,"url":"https://github.com/panva/jose","children":[{"type":"text","value":"Jose","position":{"start":{"line":18,"column":8,"offset":881},"end":{"line":18,"column":12,"offset":885}}}],"position":{"start":{"line":18,"column":7,"offset":880},"end":{"line":18,"column":44,"offset":917}},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":" it would look something like this to authenticate the token and either return the validated signature or fail.\n","position":{"start":{"line":18,"column":44,"offset":917},"end":{"line":19,"column":1,"offset":1029}}},{"type":"image","title":null,"url":"https://dev-to-uploads.s3.amazonaws.com/i/z8brq5fo3mv850o1z1fu.png","alt":"Alt Text","position":{"start":{"line":19,"column":1,"offset":1029},"end":{"line":19,"column":80,"offset":1108}}}],"position":{"start":{"line":18,"column":1,"offset":874},"end":{"line":19,"column":80,"offset":1108}}},{"type":"paragraph","children":[{"type":"text","value":"You may need to get the token from the head in a more specific way like so.","position":{"start":{"line":21,"column":1,"offset":1110},"end":{"line":21,"column":76,"offset":1185}}}],"position":{"start":{"line":21,"column":1,"offset":1110},"end":{"line":21,"column":76,"offset":1185}}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    let token = context?.request?.headers().authorization || &#39;&#39;\n    // Remove &quot;Bearer &quot; from start of token\n    return (token = token.substring(7, token.length)) </code></pre></div>","position":{"start":{"line":22,"column":1,"offset":1186},"end":{"line":26,"column":4,"offset":1356}}},{"type":"paragraph","children":[{"type":"text","value":"From here is just a matter of ","position":{"start":{"line":28,"column":1,"offset":1358},"end":{"line":28,"column":31,"offset":1388}}},{"type":"strong","children":[{"type":"text","value":"context","position":{"start":{"line":28,"column":33,"offset":1390},"end":{"line":28,"column":40,"offset":1397}}}],"position":{"start":{"line":28,"column":31,"offset":1388},"end":{"line":28,"column":42,"offset":1399}}},{"type":"text","value":" depending on what language you are using.","position":{"start":{"line":28,"column":42,"offset":1399},"end":{"line":28,"column":84,"offset":1441}}}],"position":{"start":{"line":28,"column":1,"offset":1358},"end":{"line":28,"column":84,"offset":1441}}},{"type":"paragraph","children":[{"type":"text","value":"I hope this help some one who has read the below AWS cognito guide and found that to be underwhelming.","position":{"start":{"line":30,"column":1,"offset":1443},"end":{"line":30,"column":103,"offset":1545}}}],"position":{"start":{"line":30,"column":1,"offset":1443},"end":{"line":30,"column":103,"offset":1545}}},{"type":"paragraph","children":[{"type":"text","value":"ðŸ––","position":{"start":{"line":32,"column":1,"offset":1547},"end":{"line":32,"column":3,"offset":1549}}}],"position":{"start":{"line":32,"column":1,"offset":1547},"end":{"line":32,"column":3,"offset":1549}}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"References","position":{"start":{"line":35,"column":3,"offset":1554},"end":{"line":35,"column":13,"offset":1564}}}],"position":{"start":{"line":35,"column":3,"offset":1554},"end":{"line":35,"column":13,"offset":1564}}}],"position":{"start":{"line":35,"column":1,"offset":1552},"end":{"line":35,"column":13,"offset":1564}}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-verifying-a-jwt.html","children":[{"type":"text","value":"AWS Guide","position":{"start":{"line":36,"column":2,"offset":1566},"end":{"line":36,"column":11,"offset":1575}}}],"position":{"start":{"line":36,"column":1,"offset":1565},"end":{"line":36,"column":131,"offset":1695}},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}},{"type":"text","value":" - ","position":{"start":{"line":36,"column":131,"offset":1695},"end":{"line":36,"column":134,"offset":1698}}},{"type":"link","title":null,"url":"https://github.com/panva/jose","children":[{"type":"text","value":"Jose","position":{"start":{"line":36,"column":135,"offset":1699},"end":{"line":36,"column":139,"offset":1703}}}],"position":{"start":{"line":36,"column":134,"offset":1698},"end":{"line":36,"column":171,"offset":1735}},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}}],"position":{"start":{"line":36,"column":1,"offset":1565},"end":{"line":36,"column":171,"offset":1735}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":39,"column":1,"offset":1738}}}}